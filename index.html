<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Umbrella Company Rate Calculator</title>
    <style>
        :root {
            --primary: #e91e63; --secondary: #f06292; --primary-rgb: 233, 30, 99;
            --card-bg: #fff; --input-bg: #f8f9fa; --text: #333; --border: #ddd;
        }
        [data-theme="dark"] {
            --card-bg: #2d3748; --input-bg: #4a5568; --text: #e2e8f0; --border: #4a5568;
        }
        
        * { box-sizing: border-box; transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease; }
        body { font-family: 'Segoe UI', sans-serif; max-width: 1000px; margin: 0 auto; padding: 20px; 
               background: linear-gradient(135deg, var(--primary), var(--secondary)); min-height: 100vh; transition: background 0.6s ease; }
        .container { background: var(--card-bg); border-radius: 15px; padding: 30px; box-shadow: 0 10px 30px rgba(0,0,0,0.2); transition: all 0.3s ease; }
        
        h1 { color: var(--text); text-align: center; margin: 0 0 10px; font-size: 2.2em; }
        .subtitle { text-align: center; color: #555; margin: 0 0 30px; }
        .subtitle.edition { font-size: 1.3em; font-weight: 500; margin-bottom: 10px; }
        [data-theme="dark"] .subtitle { color: #ccc; }
        [data-theme="dark"] .subtitle.edition { color: #eee; }
        
        .input-section { background: var(--input-bg); padding: 20px; border-radius: 10px; margin-bottom: 20px; }
        .control-group { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 15px; }
        .control { display: flex; flex-direction: column; }
        label { font-weight: 600; color: var(--text); margin-bottom: 5px; font-size: 14px; }
        input, select { padding: 12px; border: 1px solid var(--border); border-radius: 6px; font-size: 16px; 
                       background: var(--card-bg); color: var(--text); }
        input[type="range"] { accent-color: var(--primary); transition: accent-color 0.6s ease; }
        #expensesDisplay { color: var(--text); font-weight: 600; margin-top: 5px; display: block; }
        
        .theme-controls { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        .color-palette { display: flex; gap: 10px; }
        .color-option { width: 30px; height: 30px; border-radius: 50%; border: 2px solid transparent; cursor: pointer; }
        .color-option.active { border-color: var(--text); }
        
        .toggle { position: relative; width: 60px; height: 30px; background: #ccc; border-radius: 15px; cursor: pointer; transition: background 0.6s ease; }
        .toggle.active { background: var(--primary); }
        .toggle::after { content: ''; position: absolute; top: 3px; left: 3px; width: 24px; height: 24px; 
                        background: white; border-radius: 50%; transition: 0.3s; }
        .toggle.active::after { left: 33px; }
        
        .results { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 12px; margin: 20px 0; }
        .result-card { background: linear-gradient(135deg, var(--primary), var(--secondary)); color: white; 
                      padding: 12px; border-radius: 8px; text-align: center; display: flex; flex-direction: column; 
                      justify-content: center; min-height: 100px; transition: background 0.6s ease; }
        .result-card h3 { margin: 0 0 6px; font-size: 0.9em; line-height: 1.2; }
        .result-value { font-size: 1.3em; font-weight: bold; margin: 4px 0; }
        
        .breakdown { background: var(--input-bg); padding: 15px; border-radius: 8px; margin-top: 20px; }
        .breakdown h3 { color: var(--text); margin: 0 0 15px; }
        .breakdown-item { display: flex; justify-content: space-between; margin: 8px 0; padding: 8px 0; border-bottom: 1px solid var(--border); transition: border-color 0.3s ease; }
        .breakdown-item:last-child { border-bottom: none; }
        .breakdown-item .label { color: #555; }
        .breakdown-item .value { font-weight: 600; color: var(--text); }
        [data-theme="dark"] .breakdown-item .label { color: #ccc; }
        [data-theme="dark"] .breakdown-item { border-bottom-color: #666; }
        
        @media (max-width: 768px) {
            .control-group { grid-template-columns: 1fr; }
            .results { grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); gap: 10px; }
            .result-card { padding: 10px; min-height: 90px; }
            .result-card h3 { font-size: 0.85em; }
            .result-value { font-size: 1.2em; }
        }
        
        @media (max-width: 480px) {
            .results { grid-template-columns: 1fr 1fr; gap: 8px; }
            .result-card { padding: 8px; min-height: 80px; }
            .result-card h3 { font-size: 0.8em; }
            .result-value { font-size: 1.1em; }
        }
    </style>
</head>
<body data-theme="light">
    <div class="container">
        <h1>üíº Umbrella Company Rate Calculator</h1>
        <p class="subtitle edition">ü•ñ French Tax Brackets & Contributions Edition üç∑üßÄ</p>
        <p class="subtitle">(lamely vibe coded with Claude Sonnet 4 ü§ñ)</p>
        
        <div class="theme-controls">
            <div class="color-palette">
                <div class="color-option active" style="background: linear-gradient(45deg, #e91e63, #f06292)" data-theme="red-pink"></div>
                <div class="color-option" style="background: linear-gradient(45deg, #3f51b5, #7986cb)" data-theme="blue"></div>
                <div class="color-option" style="background: linear-gradient(45deg, #e65100, #ff8a50)" data-theme="orange"></div>
                <div class="color-option" style="background: linear-gradient(45deg, #9c27b0, #ba68c8)" data-theme="purple"></div>
                <div class="color-option" style="background: linear-gradient(45deg, #009688, #4db6ac)" data-theme="teal"></div>
            </div>
            <div style="display: flex; align-items: center; gap: 8px;">
                <span>‚òÄÔ∏è</span>
                <div class="toggle" onclick="toggleDarkMode()"></div>
                <span>üåô</span>
            </div>
        </div>
        
        <div class="input-section">
            <div class="control-group">
                <div class="control">
                    <label for="dailyRate">Daily Rate (‚Ç¨)</label>
                    <input type="number" id="dailyRate" value="600" oninput="calculate()">
                </div>
                <div class="control">
                    <label for="workingDays">Working Days/Month</label>
                    <input type="number" id="workingDays" value="20" oninput="calculate()">
                </div>
                <div class="control">
                    <label for="managementFees">Management Fees (%)</label>
                    <input type="number" id="managementFees" value="3" step="0.1" oninput="calculate()">
                </div>
                <div class="control">
                    <label for="businessExpenses">Business Expenses (‚Ç¨/month)</label>
                    <input type="range" id="businessExpenses" min="0" max="2000" value="0" oninput="calculate(); updateExpensesDisplay()">
                    <span id="expensesDisplay">0‚Ç¨</span>
                </div>
            </div>
        </div>
        
        <div class="results">
            <div class="result-card">
                <h3>üí∞ Monthly Revenue</h3>
                <div class="result-value" id="monthlyRevenue">‚Ç¨12,000</div>
            </div>
            <div class="result-card">
                <h3>üí∏ Net Salary Before Income Tax</h3>
                <div class="result-value" id="netSalaryBeforeTax">‚Ç¨7,080</div>
            </div>
            <div class="result-card">
                <h3>üèõÔ∏è Net After Tax & Expenses</h3>
                <div class="result-value" id="netAfterTax">‚Ç¨6,200</div>
            </div>
            <div class="result-card">
                <h3>üìä After-Tax/Revenue Ratio</h3>
                <div class="result-value" id="ratio">52%</div>
            </div>
        </div>
        
        <div class="breakdown">
            <h3>üíº Breakdown</h3>
            <div class="breakdown-item"><span class="label">Monthly Revenue (Daily Rate √ó Days)</span><span class="value" id="breakdown-revenue">‚Ç¨12,000</span></div>
            <div class="breakdown-item"><span class="label">Management Fees (3%)</span><span class="value" id="breakdown-mgmt">-‚Ç¨840</span></div>
            <div class="breakdown-item"><span class="label">Employer Social Contributions (30.87%)</span><span class="value" id="breakdown-employer">-‚Ç¨3,444</span></div>
            <div class="breakdown-item"><span class="label">Gross Salary</span><span class="value" id="breakdown-gross">‚Ç¨7,716</span></div>
            <div class="breakdown-item"><span class="label">Employee Social Contributions (11.98%)</span><span class="value" id="breakdown-employee">-‚Ç¨924</span></div>
            <div class="breakdown-item"><span class="label">Reserve Fund (9.70%)</span><span class="value" id="breakdown-reserve">-‚Ç¨748</span></div>
            <div class="breakdown-item"><span class="label">Net Salary Before Income Tax</span><span class="value" id="breakdown-net-before">‚Ç¨6,044</span></div>
            <div class="breakdown-item"><span class="label">Income Tax</span><span class="value" id="breakdown-tax">-‚Ç¨180</span></div>
            <div class="breakdown-item"><span class="label">Business Expenses (Deductible)</span><span class="value" id="breakdown-expenses">-‚Ç¨300</span></div>
            <div class="breakdown-item"><span class="label">Net After Tax & Expenses</span><span class="value" id="breakdown-final">‚Ç¨5,564</span></div>
        </div>
    </div>

    <script>
        const themes = {
            'red-pink': { primary: '#e91e63', secondary: '#f06292', rgb: '233, 30, 99' },
            'blue': { primary: '#3f51b5', secondary: '#7986cb', rgb: '63, 81, 181' },
            'orange': { primary: '#e65100', secondary: '#ff8a50', rgb: '230, 81, 0' },
            'purple': { primary: '#9c27b0', secondary: '#ba68c8', rgb: '156, 39, 176' },
            'teal': { primary: '#009688', secondary: '#4db6ac', rgb: '0, 150, 136' }
        };

        function changeColorTheme(themeName) {
            const theme = themes[themeName];
            document.documentElement.style.setProperty('--primary', theme.primary);
            document.documentElement.style.setProperty('--secondary', theme.secondary);
            document.documentElement.style.setProperty('--primary-rgb', theme.rgb);
            document.querySelectorAll('.color-option').forEach(opt => opt.classList.remove('active'));
            document.querySelector(`[data-theme="${themeName}"]`).classList.add('active');
            localStorage.setItem('selectedTheme', themeName);
        }

        function toggleDarkMode() {
            const toggle = document.querySelector('.toggle');
            const body = document.body;
            const isDark = body.dataset.theme === 'dark';
            body.dataset.theme = isDark ? 'light' : 'dark';
            toggle.classList.toggle('active', !isDark);
            localStorage.setItem('darkMode', !isDark);
        }

        // Social contribution rates from French umbrella company structure
        const EMPLOYER_SOCIAL_CONTRIBUTIONS_RATE = 30.87 / 100; // 3305.51 / 10710
        const EMPLOYEE_SOCIAL_CONTRIBUTIONS_RATE = 11.98 / 100; // 1283.37 / 10710
        const RESERVE_FUND_RATE = 9.70 / 100;           // 1038.87 / 10710

        // French income tax brackets for 2025 (for single person)
        const TAX_BRACKETS = [
            { min: 0, max: 11497, rate: 0.00 },
            { min: 11498, max: 29315, rate: 0.11 },
            { min: 29316, max: 83823, rate: 0.30 },
            { min: 83824, max: 180294, rate: 0.41 },
            { min: 180295, max: Infinity, rate: 0.45 }
        ];

        function calculateIncomeTax(annualSalary) {
            let tax = 0;
            
            for (const bracket of TAX_BRACKETS) {
                if (annualSalary > bracket.min) {
                    const taxableInBracket = Math.min(annualSalary, bracket.max) - bracket.min + 1;
                    tax += taxableInBracket * bracket.rate;
                }
            }
            
            return tax;
        }

        function calculate() {
            const dailyRate = parseFloat(document.getElementById('dailyRate').value) || 0;
            const workingDays = parseFloat(document.getElementById('workingDays').value) || 0;
            const managementFeesRate = (parseFloat(document.getElementById('managementFees').value) || 3.0) / 100;
            const businessExpenses = parseFloat(document.getElementById('businessExpenses').value) || 0;
            
            const monthlyRevenue = dailyRate * workingDays;
            const employerSocialContributions = monthlyRevenue * EMPLOYER_SOCIAL_CONTRIBUTIONS_RATE;
            const employeeSocialContributions = monthlyRevenue * EMPLOYEE_SOCIAL_CONTRIBUTIONS_RATE;
            const umbrellaCompanyFees = monthlyRevenue * managementFeesRate;
            const reserveFund = monthlyRevenue * RESERVE_FUND_RATE;
            const netBeforeTax = monthlyRevenue - employerSocialContributions - employeeSocialContributions - umbrellaCompanyFees - reserveFund;
            
            // Calculate annual salary and income tax (business expenses reduce taxable income)
            const annualSalaryBeforeTax = (netBeforeTax - businessExpenses) * 12;
            const annualIncomeTax = calculateIncomeTax(Math.max(0, annualSalaryBeforeTax));
            const monthlyIncomeTax = annualIncomeTax / 12;
            const netAfterTax = netBeforeTax - monthlyIncomeTax - businessExpenses;
            
            const ratio = monthlyRevenue > 0 ? (netAfterTax / monthlyRevenue * 100) : 0;

            // Update slider display
            document.getElementById('expensesDisplay').textContent = `${businessExpenses}‚Ç¨`;
            
            // Update main results
            document.getElementById('monthlyRevenue').textContent = `‚Ç¨${formatEuro(monthlyRevenue)}`;
            document.getElementById('netSalaryBeforeTax').textContent = `‚Ç¨${formatEuro(netBeforeTax)}`;
            document.getElementById('netAfterTax').textContent = `‚Ç¨${formatEuro(netAfterTax)}`;
            document.getElementById('ratio').textContent = ratio.toFixed(1) + '%';
            
            // Update breakdown
            document.getElementById('breakdown-revenue').textContent = `‚Ç¨${formatEuro(monthlyRevenue)}`;
            document.getElementById('breakdown-mgmt').textContent = `-‚Ç¨${formatEuro(umbrellaCompanyFees)}`;
            document.getElementById('breakdown-employer').textContent = `-‚Ç¨${formatEuro(employerSocialContributions)}`;
            document.getElementById('breakdown-gross').textContent = `‚Ç¨${formatEuro(monthlyRevenue - employerSocialContributions - employeeSocialContributions - umbrellaCompanyFees - reserveFund + employeeSocialContributions + reserveFund)}`;
            document.getElementById('breakdown-employee').textContent = `-‚Ç¨${formatEuro(employeeSocialContributions)}`;
            document.getElementById('breakdown-reserve').textContent = `-‚Ç¨${formatEuro(reserveFund)}`;
            document.getElementById('breakdown-net-before').textContent = `‚Ç¨${formatEuro(netBeforeTax)}`;
            document.getElementById('breakdown-tax').textContent = `-‚Ç¨${formatEuro(monthlyIncomeTax)}`;
            document.getElementById('breakdown-expenses').textContent = `-‚Ç¨${formatEuro(businessExpenses)}`;
            document.getElementById('breakdown-final').textContent = `‚Ç¨${formatEuro(netAfterTax)}`;
        }
        
        function formatEuro(amount) {
            return new Intl.NumberFormat('fr-FR', {
                minimumFractionDigits: 0,
                maximumFractionDigits: 0
            }).format(Math.round(amount));
        }

        function updateExpensesDisplay() {
            const value = document.getElementById('businessExpenses').value;
            document.getElementById('expensesDisplay').textContent = `${value}‚Ç¨`;
        }

        // Initialize
        document.querySelectorAll('.color-option').forEach(option => {
            option.addEventListener('click', () => changeColorTheme(option.dataset.theme));
        });

        // Load saved preferences
        const savedTheme = localStorage.getItem('selectedTheme') || 'red-pink';
        const savedDarkMode = localStorage.getItem('darkMode') === 'true';
        changeColorTheme(savedTheme);
        if (savedDarkMode) toggleDarkMode();
        calculate();
    </script>
</body>
</html>
